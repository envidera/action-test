name: 'Auto Changelog from CHANGELOG.md'
description: 'A reusable action'
inputs:
  file:
    description: 'The CHANGELOG.md file to read from'
    required: true

runs:
  using: 'composite'
  steps:
    - name: Generate Auto Changelog
      shell: bash
      run: |
        # Define the variable from input
        CHANGELOG_FILE="${{ inputs.file }}"

        # Create the changelog.txt file with header
        {
            echo "## Changelog" 
            echo ""
            echo "> Auto-generated from CHANGELOG.md"
        } > changelog.txt

        # Extract content using awk and append to changelog.txt
        awk '
        BEGIN { inside_section = 0; }
        /^## v[0-9]+/ {
          if (inside_section == 1) {
            exit;
          }
          inside_section = 1;
          next;
        }
        inside_section == 1 {
          print;
        }' "$CHANGELOG_FILE" >> changelog.txt
